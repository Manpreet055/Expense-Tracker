import{renderContentHeader,sortList}from"./components.js";let date=document.querySelector("#date");let description=document.querySelector("#description");let amount=document.querySelector("#amount");let inputElements=document.querySelectorAll("input");let form=document.querySelector(".record-form");let contentWrapper=document.querySelector(".content-wrapper");let localStorageKey=null;let title=document.querySelector("title");if(title.textContent==="Contribution Tracker"){localStorageKey="Contributions"}else if(title.textContent==="Expense Tracker"){localStorageKey="Expenses"}let records=JSON.parse(localStorage.getItem(localStorageKey))||[];let editingElement=null;let total=document.querySelector(".grand-total");let totalExpense=0;let menuButton=document.querySelector(".menu");let menuCard=document.querySelector(".menu-card");if(localStorage.getItem("Dark Mode")==="true"){document.body.classList.add("dark");document.body.style.transition="none";let darkModeButton=menuCard.querySelector(".dark-mode");if(darkModeButton){darkModeButton.innerHTML=`Light Mode &#9728;`}}records.forEach((record=>{showData(record)}));function capitalize(str){if(!str)return str;return str.charAt(0).toUpperCase()+str.slice(1)}function showData(record){let content=document.createElement("div");content.className="content";content.dataset.date=record.date;content.dataset.description=record.description;content.dataset.amount=record.amount;let dateSpan=document.createElement("span");let dateObj=new Date(record.date);let monthName=dateObj.toLocaleString("default",{month:"short"});let day=dateObj.getDate();dateSpan.textContent=`${monthName} - ${day}`;content.appendChild(dateSpan);let descriptionSpan=document.createElement("span");descriptionSpan.textContent=capitalize(record.description);content.appendChild(descriptionSpan);let amount=document.createElement("span");amount.textContent="₹"+record.amount;content.appendChild(amount);let iconWrapper=document.createElement("div");iconWrapper.className="icon-wrapper";let deleteButton=document.createElement("i");deleteButton.className="fas fa-trash delete-button";iconWrapper.appendChild(deleteButton);let editButton=document.createElement("i");editButton.className="fas fa-edit edit-button";iconWrapper.appendChild(editButton);content.appendChild(iconWrapper);contentWrapper.appendChild(content);totalExpense+=Number(record.amount);total.textContent=`₹ ${totalExpense} `}function submitForm(event){event.preventDefault();let formdata={date:date.value.trim(),description:description.value.trim(),amount:amount.value.trim()};if(editingElement){storageUpdate(editingElement);document.querySelector("#submit").textContent="Submit"}if(formdata.date.trim()==""||formdata.description.trim()==""||formdata.amount.trim()==""){alert("Empty input field..")}else{let isDuplicate=records.some((record=>record.date===formdata.date&&record.description===formdata.description&&record.amount===formdata.amount));if(isDuplicate){alert("This record already exist !!");form.reset()}else{records.push(formdata);localStorage.setItem(localStorageKey,JSON.stringify(records));contentWrapper.innerHTML="";contentWrapper.innerHTML=renderContentHeader();records.forEach((record=>{showData(record)}));form.reset()}}}form.addEventListener("submit",(event=>{submitForm(event)}));inputElements.forEach((input=>{input.addEventListener("keydown",(event=>{if(event.key==="Enter"){submitForm(event)}}))}));menuButton.addEventListener("click",(()=>{menuCard.style.display="grid";setTimeout((()=>{menuCard.style.opacity="1";menuCard.style.transform="translateX(0)"}),200)}));document.addEventListener("click",(event=>{if(!menuButton.contains(event.target)&&!menuCard.contains(event.target)){menuCard.style.opacity="0.5";menuCard.style.transform="translateX(-100%)";setTimeout((()=>{menuCard.style.display="none"}),200)}}));function storageUpdate(clickedButton){records=records.filter((record=>!(record.date===clickedButton.dataset.date&&record.description===clickedButton.dataset.description&&record.amount===clickedButton.dataset.amount)));localStorage.setItem(localStorageKey,JSON.stringify(records));clickedButton.style.opacity="0.5";clickedButton.style.transform="translatex(-200px)";setTimeout((()=>{totalExpense-=Number(clickedButton.dataset.amount);total.textContent=`₹ ${totalExpense}`;clickedButton.remove()}),200)}contentWrapper.addEventListener("click",(event=>{if(event.target.matches(".delete-button")){if(!confirm("Do you really want to delete ??")){return}let clickedButton=event.target.closest(".content");storageUpdate(clickedButton)}if(event.target.matches(".edit-button")){let clickedButton=event.target.closest(".content");date.value=clickedButton.dataset.date;description.value=clickedButton.dataset.description;amount.value=clickedButton.dataset.amount;document.querySelector("#submit").textContent="Update";editingElement=clickedButton}}));menuCard.addEventListener("click",(event=>{if(!event.target.matches("#sort-dropdown")){menuCard.style.opacity="0.5";menuCard.style.transform="translateX(-100%)";setTimeout((()=>{menuCard.style.display="none"}),200)}if(event.target.matches(".dark-mode")){document.body.classList.toggle("dark");if(document.body.classList.contains("dark")){event.target.innerHTML="Light Mode &#9728;"}else{event.target.innerHTML='Dark Mode <i class="fas fa-moon dark-mode-icon"></i>'}localStorage.setItem("Dark Mode",document.body.classList.contains("dark"))}}));document.querySelector(".reset").addEventListener("click",(()=>{if(records.length===0&&contentWrapper.innerHTML.trim()===""){alert("List is already Empty !!");return}if(!confirm("Do you really want to Delete ?"))return;contentWrapper.innerHTML="";records=[];localStorage.setItem(localStorageKey,JSON.stringify(records));alert("All records cleared successfully !!")}));let sorting=document.querySelector("#sort-dropdown");sorting.addEventListener("change",(()=>{let clickOption=sorting.value;totalExpense=0;sortList(clickOption);console.log(clickOption)}));export{showData};